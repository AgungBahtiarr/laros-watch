<!DOCTYPE html>
<html lang="en">
<head>
    <title>SSE Test</title>
</head>
<body>
    <h1>Testing SSE Connection...</h1>
    <p>Check the browser console (F12) and your backend terminal for logs.</p>
    <div id="events"></div>

    <script>
        console.log("Script starting...");
        const eventContainer = document.getElementById('events');

        try {
            const eventSource = new EventSource('http://localhost:3000/api/nodes/status/events');

            eventSource.onopen = function() {
                console.log("SSE Connection Opened!");
                eventContainer.innerHTML += '<p>Connection Opened!</p>';
            };

            eventSource.addEventListener('notification', function(event) {
                console.log("Notification received:", event.data);
                eventContainer.innerHTML += '<p>Notification: ' + event.data + '</p>';
            });

            eventSource.onerror = function(err) {
                console.error("EventSource failed:", err);
                eventContainer.innerHTML += '<p style="color: red;">EventSource failed. See console.</p>';
            };

            console.log("EventSource object created. Waiting for events.");

        } catch (e) {
            console.error("Error creating EventSource:", e);
            eventContainer.innerHTML += '<p style="color: red;">Error creating EventSource. See console.</p>';
        }
    </script>
</body>
</html>
